<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zatex Bot Help</title>
  <!-- CSS ОСТАЁТСЯ БЕЗ ИЗМЕНЕНИЙ — опущено здесь для краткости -->
  <style>/* ... твой CSS без изменений ... */</style>
</head>
<body>
  <h1 id="title">Zatex Bot Help</h1>

  <!-- Sections -->
  <div class="section" id="section1">
    <div class="section-summary" id="section1_title">
      Parameters — what does each one control?
      <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5H7z" /></svg>
    </div>
    <div class="section-details" id="section1_content"></div>
  </div>

  <div class="section" id="section2">
    <div class="section-summary" id="section2_title">
      Soft pity — what is it and how does it work?
      <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5H7z" /></svg>
    </div>
    <div class="section-details" id="section2_content"></div>
  </div>

  <div class="section" id="section3">
    <div class="section-summary" id="section3_title">
      Simulation modes — what's the difference?
      <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5H7z" /></svg>
    </div>
    <div class="section-details" id="section3_content"></div>
  </div>

  <div class="section" id="section4">
    <div class="section-summary" id="section4_title">
      Limits — why do they exist and how to bypass?
      <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5H7z" /></svg>
    </div>
    <div class="section-details" id="section4_content"></div>
  </div>

  <!-- Language selector -->
  <footer>
    <div class="language-selector">
      <div class="lang-wrapper">
        <select id="langSelector">
          <option value="en">English</option>
          <option value="ru">Русский</option>
          <option value="ja">日本語</option>
          <option value="ko">한국어</option>
          <option value="zh">中文</option>
          <option value="es">Español</option>
          <option value="pt-BR">Português</option>
          <option value="fr">Français</option>
        </select>
        <svg viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2"
          stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" focusable="false">
          <circle cx="12" cy="12" r="10"/>
          <path d="M2 12h20"/>
          <path d="M12 2a15.3 15.3 0 0 1 0 20"/>
          <path d="M12 2a15.3 15.3 0 0 0 0 20"/>
        </svg>
      </div>
    </div>
  </footer>

  <!-- Script -->
  <script src="../languages.js"></script>
  <script>
    const langSelector = document.getElementById("langSelector");
    const titleElement = document.getElementById("title");
    const sectionTitles = [
      document.getElementById("section1_title"),
      document.getElementById("section2_title"),
      document.getElementById("section3_title"),
      document.getElementById("section4_title"),
    ];
    const sectionContents = [
      document.getElementById("section1_content"),
      document.getElementById("section2_content"),
      document.getElementById("section3_content"),
      document.getElementById("section4_content"),
    ];

    function getCurrentLangFromPath() {
      const parts = window.location.pathname.split('/');
      const lang = parts[1];
      const supported = ["en", "ru", "ja", "ko", "zh", "es", "pt-BR", "fr"];
      return supported.includes(lang) ? lang : "en";
    }

    function setLanguage(lang) {
      const langData = translations[lang] || translations.en;
      titleElement.textContent = langData.title;
      for (let i = 0; i < 4; i++) {
        sectionTitles[i].childNodes[0].textContent = langData[`section${i + 1}_title`];
        sectionContents[i].innerHTML = langData[`section${i + 1}_content`];
      }
      document.body.classList.toggle("rtl", lang === "ar");
      langSelector.value = lang;
    }

    function changeLanguageURL(lang) {
      const currentPath = window.location.pathname;
      const parts = currentPath.split('/');
      parts[1] = lang; // заменяем язык в URL
      const newURL = parts.join('/') + window.location.hash;
      window.location.href = newURL;
    }

    function initAccordion() {
      document.querySelectorAll(".section-summary").forEach((summary) => {
        const details = summary.nextElementSibling;
        summary.addEventListener("click", () => {
          const isOpen = details.classList.contains("open");
          if (isOpen) {
            details.style.maxHeight = details.scrollHeight + "px";
            requestAnimationFrame(() => {
              details.style.maxHeight = "0";
              details.classList.remove("open");
              summary.classList.remove("active");
            });
          } else {
            details.classList.add("open");
            summary.classList.add("active");
            details.style.maxHeight = details.scrollHeight + "px";
          }
        });

        details.addEventListener("transitionend", () => {
          if (details.classList.contains("open")) {
            details.style.maxHeight = "none";
          }
        });
      });
    }

    function openSectionByHash() {
      const hash = window.location.hash;
      if (hash && hash.startsWith("#section")) {
        const section = document.querySelector(hash);
        const summary = section?.querySelector(".section-summary");
        const details = section?.querySelector(".section-details");
        if (summary && details) {
          details.classList.add("open");
          summary.classList.add("active");
          details.style.maxHeight = details.scrollHeight + "px";
          setTimeout(() => {
            section.scrollIntoView({ behavior: "smooth", block: "start" });
          }, 100);
        }
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      const currentLang = getCurrentLangFromPath();
      setLanguage(currentLang);
      initAccordion();
      openSectionByHash();
      langSelector.addEventListener("change", (e) => changeLanguageURL(e.target.value));
    });

    window.addEventListener("hashchange", openSectionByHash);
  </script>
</body>
</html>